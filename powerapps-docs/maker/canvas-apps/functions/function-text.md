---
title: Text 函数 | Microsoft 文档
description: Power Apps 中的文本函数的参考信息（包括语法和示例）
author: gregli-msft
manager: kvivek
ms.service: powerapps
ms.topic: reference
ms.custom: canvas
ms.reviewer: tapanm
ms.date: 11/14/2018
ms.author: gregli
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 9ebc28c72d1d25c4a6e85e25a14c8addaf457318
ms.sourcegitcommit: 6b27eae6dd8a53f224a8dc7d0aa00e334d6fed15
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/03/2019
ms.locfileid: "74729974"
---
# <a name="text-function-in-power-apps"></a>Power Apps 中的文本函数
将数值或日期/时间值的格式转换为文本字符串。

## <a name="description"></a>描述
**Text** 函数根据下面的一种参数类型设置数字或日期/时间值的格式：

* 预定义的日期/时间格式，可使用 **DateTimeFormat** 枚举指定。 对于日期和时间，此方法是首选方法，因为它会自动调整为每个用户的语言和区域。
* 一种自定义格式，它包含定义的占位符的字符串，例如，数字是否显示小数点分隔符和日期显示月份的完整名称、月份的缩写形式或月份号。 Power Apps 支持 Microsoft Excel 所用的占位符的子集。 在此字符串中，语言占位符指定解释其他占位符所用的语言。 例如，如果自定义格式包含句点，则语言格式占位符指定该句点是小数点分隔符（ja-jp）还是千位分隔符（es）。

有关详细信息，请参阅[处理日期和时间](../show-text-dates-times.md)。

**Text**函数还可以使用默认格式将任何数据类型转换为文本表示形式。 使用此功能可将非文本值传递到基于文本的函数，如[**Len**](function-len.md)、 [**Right**](function-left-mid-right.md)和[**IsMatch**](function-ismatch.md)。

### <a name="predefined-datetime-formats"></a>预定义的日期/时间格式

| 预定义的格式 | 描述 |
| --- | --- |
| **DateTimeFormat.LongDate** |完整的年份、月份、相应月份中的多少号和星期几。 月份名称和星期几不采用缩写形式。 |
| **DateTimeFormat.LongDateTime** |完整的年份、月份、相应月份中的多少号和星期几，外加时（12 小时制）、分、秒和 AM/PM 标记。 月份名称和星期几不采用缩写形式。 |
| **DateTimeFormat.LongDateTime24** |完整的年份、月份、相应月份中的多少号和星期几，外加时（24 小时制）、分和秒。 月份名称和星期几不采用缩写形式。 |
| **DateTimeFormat.LongTime** |时（12 小时制）、分、秒和 AM/PM 标记。 与 ShortTime 相同。 |
| **DateTimeFormat.LongTime24** |时（24 小时制）、分和秒。 与 ShortTime24 相同。 |
| **DateTimeFormat.ShortDate** |四位数的年份和两位数的月份及相应月份中的多少号。 |
| **DateTimeFormat.ShortDateTime** |四位数的年份和两位数的月份及相应月份中的多少号，外加时（12 小时制）、分、秒和 AM/PM 标记。 |
| **DateTimeFormat.ShortDateTime24** |四位数的年份和两位数的月份及相应月份中的多少号，外加时（24 小时制）、分和秒。 |
| **DateTimeFormat.ShortTime** |时（12 小时制）、分、秒和 AM/PM 标记。  与 LongTime 相同。 |
| **DateTimeFormat.ShortTime24** |时（24 小时制）、分和秒。  与 LongTime24 相同。 |
| **DateTimeFormat.UTC** |根据当前用户所在的时区将日期/时间值转换为 UTC，并根据 ISO 8601 标准设置格式。 |

### <a name="number-placeholders"></a>数字占位符

| 占位符 | 描述 |
| --- | --- |
| **0**（*零*） |如果数字的位数少于包含零的格式中的位数，显示无意义的零。 例如，如果要将 **8.9** 显示为 **8.90**，请使用 **#.00** 格式。 |
| **#** |与 **0**（零）的规则相同。 不过，如果数字的小数点前/后位数少于包含 # 符号的格式中的位数，**Text** 不返回多余的零。 例如，如果自定义格式为 **#.##** ，而要设置格式的数字为 **8.9**，则显示的是 **8.9**。 |
| **.** （*句点*） |在数字中显示小数点。 取决于自定义格式的语言;有关更多详细信息，请参阅[全局应用](#global-apps)。 |
| **,** （*逗号*） |在数字中显示分组分隔符，通常是千位分隔符。 如果格式中的逗号的前后是数字记号 ( **#** ) 或零，**Text** 使用逗号分隔各组。 取决于自定义格式的语言;有关更多详细信息，请参阅[全局应用](#global-apps)。 |

如果数字的小数点后面的位数多于包含占位符的格式中的位数，则数字四舍五入为与占位符相同的位数。 如果小数点前面的位数多于包含占位符的格式中的位数，则显示多余的位数。 如果格式中小数点前面仅包含数字记号 (#)，则小于 1 的数字以小数点开头（例如， **.47**）。

### <a name="date-and-time-placeholders"></a>日期和时间占位符

|   占位符    |   描述                                                  |
|------------------|----------------------------------------------------------------|
|  **m**   |   将月份显示为不带前导零的数字。               |
|  **mm**  |   视情况将月份显示为带前导零的数字。 |
|  **mmm** |   以缩写形式（**Jan** 到 **Dec**）显示月份。          |
|                                                                                                   **mmmm**                                                                                                   |                                                                          以全称形式（**January** 到 **December**）显示月份。                                                                           |
|                                                                                                    **d**                                                                                                     |                                                                                将日期显示为不带前导零的数字。                                                                                 |
|                                                                                                    **dd**                                                                                                    |                                                                         视情况将日期显示为带前导零的数字。                                                                          |
|                                                                                                   **ddd**                                                                                                    |                                                                              以缩写形式（**Sun** 到 **Sat**）显示日期。                                                                              |
|                                                                                                   **dddd**                                                                                                   |                                                                            以全称形式（**Sunday** 到 **Saturday**）显示日期。                                                                            |
|                                                                                                    **yy**                                                                                                    |                                                                                      将年份显示为两位数的数字。                                                                                       |
|                                                                                                   **yyyy**                                                                                                   |                                                                                      将年份显示为四位数的数字。                                                                                      |
|                                                                                                    **h**                                                                                                     |                                                                                将小时显示为不带前导零的数字。                                                                                |
|   **hh** | 视情况将小时显示为带前导零的数字。 如果格式中包含 **AM** 或 **PM**，以 12 小时制显示小时。 如果不包含，以 24 小时制显示小时。 | 
|  **m**   |   将分显示为不带前导零的数字。<br><br>此占位符必须紧跟在**h**或**hh**代码之后或紧跟在**ss**代码之前;否则， **Text**返回月份而不是分钟。  |    
| **mm**   | 视情况将分显示为带前导零的数字。<br><br>此占位符必须紧跟在**h**或**hh**占位符之后或在**ss**占位符之前。 否则， **Text**返回月份而不是分钟。 |                                                                                                                   
| **s**   |  将秒显示为不带前导零的数字。  |
| **ss**  | 视情况将秒显示为带前导零的数字。                                                                        |
|                                                                                                    **f**                                                                                                     |                                                                                         显示秒的小数部分。                                                                                          |
|                                                                                    **AM/PM**、 **a/p**                                                                                    |               以 12 小时制显示小时。 **文本**返回 "AM" 或 "a" 表示从午夜到中午之间的时间，或从中午开始到午夜的时间。                |

### <a name="literal-placeholders"></a>文本占位符
可以在格式字符串中添加以下任意字符。  这些字符将按原样显示在 **Text** 结果中。 其他字符留待用于以后的占位符，因此不得使用其他字符。

| 字符 | 描述 |
| --- | --- |
| 任意货币符号 |美元符号、分币符号、欧元符号等 |
| **+** |正号 |
| **(** |左小括号 |
| **:** |冒号 |
| **^** |扬抑符（脱字号） |
| **'** |撇号 |
| **{** |左花括号 |
| **<** |小于号 |
| **=** |等于号 |
| **-** |负号 |
| **/** |左斜线 |
| **)** |右小括号 |
| **&** |& 号 |
| **~** |波形符 |
| **}** |右花括号 |
| **>** |大于号 |
| &nbsp; |空格字符 |

## <a name="global-apps"></a>全局应用
**Text** 函数具有全局感知能力。 对于各种语言，此函数都能确定如何正确写出日期、时间、货币和数字。 它需要获取以下两条信息才能正常运行：

* **自定义格式的语言：** 对于制造商来说，如何解释自定义格式呢？ 分隔符（ **.** 和 **,** ）的含义因语言而异。 如果指定自定义格式，则可以包括语言占位符，或采用默认值，这反映了设备设置的语言。 更简单的是，您可以使用[预定义的日期/时间格式](#predefined-datetime-formats)，这种格式不可知。
* **结果的语言：** 对于用户，函数结果应采用哪种语言显示？ 月份和工作日的名称必须为应用的用户所需的语言，可通过将第三个可选参数添加到**文本**函数来指定。 

对于这两种情况，使用[语言标记](function-language.md#language-tags)指定语言。 若要查看支持的语言列表，请在右侧窗格的编辑栏或 "**高级**" 选项卡中键入**Text （1234，""，）** ，然后滚动到建议用于第三个参数的区域设置列表。

### <a name="language-placeholder"></a>语言占位符
若要指定自定义格式的语言，请使用：

| 占位符 | 描述 |
| --- | --- |
| **[$-LanguageTag]** |*LanguageTag* 是 **Language** 函数返回的语言标记。 它可以仅指定语言（例如英语的 **[$ en]** ），也可以指定区域（如 **[$-en-us]** ），进一步指定英国。 |

语言占位符可以显示在自定义格式中的任意位置，但只能出现一次。

如果指定的自定义格式没有语言占位符，并且格式在全局角度上不明确，则会自动插入当前语言的语言标记。  

如果应用运行时不存在此占位符，则假定为 **[$-en-us]** 。 

> [!NOTE]
> 在将来的版本中，此占位符的语法可能会更改，以避免与 Excel 支持的类似但不同的占位符混淆。

### <a name="result-language-tag"></a>结果语言标记
**文本**的结果包括月、工作日和 AM/PM 称号的已翻译字符串，以及适当的组和小数分隔符。

默认情况下，**Text** 使用应用用户的语言。 **Language** 函数返回当前用户的语言标记。 可以通过为**文本**的第三个参数提供语言标记来覆盖此默认值。

## <a name="syntax"></a>语法
**Text**（ *NumberOrDateTime*， *DateTimeFormatEnum* [， *ResultLanguageTag* ]）

* *NumberOrDateTime* -必需。 要设置格式的数字或日期/时间值。
* *DateTimeFormat* - 必需。  **DateTimeFormat** 枚举的成员。
* *ResultLanguageTag* - 可选。 要对结果文本使用的语言标记。 默认使用当前用户的语言。

**Text**（ *NumberOrDateTime*， *datetimepicker.customformat* [， *ResultLanguageTag* ]）

* *Number* - 必需。 要设置格式的数字或日期/时间值。
* *CustomFormat* - 必需。 用双引号括起的一个或多个占位符。
* *ResultLanguageTag* - 可选。 要对结果文本使用的语言标记。 默认使用当前用户的语言。

**文本**（ *AnyValue* ）

* *AnyValue* -必需。 要转换为文本表示形式的值。 使用默认格式。

## <a name="examples"></a>示例
除非另外指定，否则，运行这些公式的用户将位于美国中，并选择英语作为其语言。  **Language** 函数返回的是“en-US”。

### <a name="number"></a>Number

| 公式 | 描述 | 结果 |
| --- | --- | --- |
| **Text(&nbsp;1234.59,&nbsp;"####.#"&nbsp;)** |将数字格式设置为包含一个小数位。 |"1234.6" |
| **Text(&nbsp;8.9,&nbsp;"#.000"&nbsp;)** |根据需要，为数字的小数部分补充结尾零。 |"8.900" |
| **Text(&nbsp;0.631,&nbsp;"0.#"&nbsp;)** |根据需要，为数字的整个部分补充前导零。 |"0.6" |
| **Text(&nbsp;12,&nbsp;"#.0#"&nbsp;)**<br>**Text(&nbsp;1234.568,&nbsp;"#.0#"&nbsp;)** |为数字的小数部分补充一个小数位的零，并包含第二个小数位（若有）。 |"12.0"<br>"1234.57" |
| **Text(&nbsp;12000,&nbsp;"$ #,###"&nbsp;)**<br>**Text(&nbsp;1200000,&nbsp;"$&nbsp;#,###"&nbsp;)** |每三位数添加一个千位分隔符，并添加货币符号。 |"$&nbsp;12,000"<br>"$&nbsp;1,200,000" |

### <a name="datetime"></a>日期/时间
* **2015 年 11 月 23 日（星期一）** **2:37:47 PM**
* 美国太平洋时区 (UTC-8)

| 公式 | 描述 | 结果 |
| --- | --- | --- |
| **Text( Now(), DateTimeFormat.LongDate )** |设置为长日期字符串格式，采用当前用户的语言和区域设置。 |"Monday, November 23, 2015" |
| **Text( Now(), DateTimeFormat.LongDateTime )** |设置为长日期和时间字符串格式，采用当前用户的语言和区域设置，使用 12 小时制。 |"Monday, November 23, 2015 2:37:47 PM" |
| **Text( Now(), DateTimeFormat.LongTime24 )** |设置为长时间字符串格式，使用 24 小时制。 |"14:37:47" |
| **Text( Now(), DateTimeFormat.ShortDate )** |设置为短日期字符串格式，采用当前用户的语言和区域设置。 |"11/23/2015" |
| **Text( Now(), "d-mmm-yy" )** |使用占位符的格式： <ul><li>**d** 表示相应月份中的多少号，一位数或两位数<li>**-** 是复制到结果中的文本字符<li>**mmm** 表示三个字母的月份缩写<li>**-** 是另一个复制到结果中的文本字符<li>**yy** 表示两位数的年份缩写</ul> |"23-Nov-15" |
| **Text （1448318857 * 1000，"mmm。dd，yyyy （hh： mm： ss AM/PM） "）** | 如果将源值乘以1000，则以用户可读的格式显示 Unix 日期时间值。 | "11 月23日，2015（02:47:37 PM）" |

### <a name="global-apps"></a>全局应用

| 公式 | 描述 | 结果 |
| --- | --- | --- |
| **Text （1234567.89，"[$-fr-fr] # # # #，# # &euro;"，"fr"）** | 将空格显示为分组分隔符，将逗号作为小数点分隔符，将 **&euro;** 为货币符号。 |"1&nbsp;234&nbsp;567，89 &euro;" |
| **Text （1234567，89;"[$-fr-fr] # # # #，# # &euro;"）** | 如果源数据遵循了使用逗号作为小数点分隔符的法语自定义，则必须将区域设置更改为法语，并使用分号（而不是逗号）分隔参数以获得与上述相同的结果。 |"1&nbsp;234&nbsp;567，89 &euro;" |
| **Text( Date(2016,1,31), "dddd mmmm d" )** |以当前用户的语言返回星期几、月份和相应月份中的多少号。 由于所有占位符都与语言无关，因此无需使用格式文本语言标记。 |"星期六&nbsp;一月&nbsp;31" |
| **Text( Date(2016,1,31), "dddd mmmm d", "es-ES" )** |以“es-ES”语言返回星期几、月份和相应月份中的多少号。 |"圣多明各&nbsp;enero&nbsp;31" |

### <a name="converting-values-to-text"></a>将值转换为文本

| 公式 | 描述 | 结果 |
| --- | --- | --- |
| **Text （&nbsp;1234567.89&nbsp;）** | 将数字转换为字符串。 没有千位分隔符，也不能控制小数点分隔符前后的位数;若要获得更多控制，请将数字占位符作为第二个参数提供。 | "1234567.89" |
| **Text （&nbsp;DateTimeValue （&nbsp;"01/04/2003"&nbsp;）&nbsp;）** | 将日期/时间值转换为文本字符串。 若要控制转换，请提供 DateTimeFormat 枚举的成员或自定义格式字符串。 | "1/4/2003 12:00 AM" |
| **Text （&nbsp;true&nbsp;）** | 将布尔值转换为字符串。 | true |
| **Text （&nbsp;GUID （）&nbsp;）** | 将生成的 GUID 值转换为字符串。  | "f8b10550-0f12-4f08-9aa3-bb10958bc3ff" |
| **Left （&nbsp;文本（&nbsp;GUID （）&nbsp;），&nbsp;4&nbsp;）** | 返回生成的 GUID 的前四个字符。 | "2d9c" | 
