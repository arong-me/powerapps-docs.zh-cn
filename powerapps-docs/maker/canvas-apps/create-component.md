---
title: 为画布应用创建组件 |Microsoft Docs
description: 画布应用的可重用组件简介
author: yifwang
ms.service: powerapps
ms.topic: article
ms.date: 12/12/2018
ms.author: yifwang
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: 857ca2c78da5b3a7ced4d4d09dfb335fab02d47c
ms.sourcegitcommit: dd2a8a0362a8e1b64a1dac7b9f98d43da8d0bd87
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/02/2019
ms.locfileid: "74678686"
---
# <a name="create-a-component-for-canvas-apps"></a>为画布应用创建组件

> [!IMPORTANT]
> 此功能在默认情况下仍处于实验和禁用状态。 有关详细信息，请参阅[实验性和预览功能](working-with-experimental.md)。

组件是画布应用的可重复使用的构建基块，因此应用程序开发人员可以创建自定义控件以在应用程序中或跨应用程序使用。 高级功能（如自定义属性）在组件中启用了复杂的功能。 本文介绍组件概念和一些示例。

组件可用于构建具有类似控件模式的大型应用程序。 如果更新组件定义，应用中的所有实例都将反映所做的更改。 你还可以通过使用一个或多个组件来提高性能，因为不会复制和粘贴控件，这会造成开销。 组件还有助于组织中的协作开发和标准化外观。

## <a name="prerequisite"></a>先决条件

打开 "**应用设置**" 屏幕，选择 "**高级设置**"，并启用该功能，并确保还启用**了改进的应用呈现**功能。

## <a name="component-canvas"></a>组件画布

你可以从 "**插入**" 选项卡上的 "**组件**" 菜单创建组件，或在左侧导航栏中按下图所示显示。 此列表显示在应用程序中定义的组件，这些组件按创建时间排序。

![组件列表视图](./media/create-component/list-view.png)

无论采用哪种方法，都将显示一个空画布，可在其中添加控件作为组件定义的一部分。 如果在画布中编辑组件，则会在其他应用程序屏幕和其他应用中更新同一组件的实例。

如果选择一个屏幕，则可以从左侧导航栏或 "**插入**" 选项卡上的 "**组件**" 菜单中的现有组件列表中选择一个组件。选择组件时，会将该组件的实例插入到屏幕上，就像插入控件一样。

## <a name="scope"></a>范围

将组件视为封装的黑色框，其属性为接口。 不能从组件外部访问组件中的控件，也不能从组件内部引用组件以外的任何内容。 如果尝试，将出现错误。 范围限制会使组件的数据协定保持简单和内聚性，并有助于实现无缝的组件定义更新，尤其是在应用程序之间。 可以通过创建一个或多个自定义属性来更新组件的数据协定。

## <a name="variables"></a>变化

组件不支持**UpdateContext**函数，但你可以通过使用**Set**函数在组件中创建和更新变量。 这些变量的作用域仅限于组件，但你可以利用自定义输出属性从组件外部访问这些变量。

## <a name="import-and-export"></a>导入和导出

若要将一个或多个组件从一个应用导入到另一个应用，请在组件的下拉列表中选择 "**导入组件**"。 对话框会列出所有包含您有权编辑的组件的应用程序。 选择应用，然后选择 "**导**入" 以导入该应用中所有组件的最新发布版本。 导入至少一个组件后，可以编辑副本并删除不需要的任何组件。

> [!div class="mx-imgBorder"]
> ![导入组件 "对话框](./media/create-component/import-components.png)

如果导出组件，请创建可导入到其他应用的本地文件。 如果应用包含同一组件的修改版本，系统将提示您确定是替换修改后的版本还是取消导入。 

## <a name="custom-properties"></a>自定义属性

如果创建一个或多个自定义属性，组件可以接收输入值和发出数据。 这些方案是高级的，需要你了解公式和绑定协定。

输入属性是组件接收要在组件中使用的数据的方式。 如果选择了组件的实例，则输入属性会显示在右侧窗格的 "**属性**" 选项卡中。 可以通过表达式或公式来配置输入属性，就像在其他控件中配置标准属性一样。 其他控件具有输入属性，如**文本输入**控件的**默认**属性。

输出属性可以发出数据或组件状态。 例如，**库**控件上的**所选**属性是 output 属性。 创建输出属性时，可以确定其他控件可以引用组件状态。

本演练进一步介绍了这些概念。

## <a name="create-an-example-component"></a>创建示例组件

在此示例中，你将创建一个类似于此图形的菜单组件，并在其中更改文本并在多个屏幕和应用程序中使用：

![最终库](./media/create-component/menu-instance.png)

1. 在 Power Apps Studio 中，创建一个空白应用。

1. 在左侧导航栏中，打开组件列表，然后选择 "**新建组件**"。

    ![组件列表](./media/create-component/component-list.png)

1. 在新组件上悬停时，选择省略号（...），选择 "**重命名**"，然后键入或粘贴**MenuComponent**。

1. 在右侧窗格中，将组件的宽度设置为**150** ，将其高度设置为**250**，然后选择 "**新建自定义属性**"。

    ![新属性](./media/create-component/new-property.png)

1. 在 "**显示名称**"、"**属性名称**" 和 "**说明**" 框中，键入或粘贴**项目**。

    ![显示名称、属性名称、说明框](./media/create-component/property-names.png)

    指定属性名称时，不要包含空格，因为在编写公式时，将通过此名称引用该组件（例如， **ComponentName**）。

    如果选择组件，显示名称将显示在右侧窗格的 "**属性**" 选项卡上。 描述性显示名称可帮助您和其他制造商了解此属性的用途。 如果将鼠标悬停在 "**属性**" 选项卡上此属性的显示名称上，则**说明**将显示在工具提示中。

1. 在 "**数据类型**" 列表中，选择 "**表**"，然后选择 "**创建**"。

    ![属性的数据类型](./media/create-component/property-data-type.png)

    **Items**属性根据您指定的数据类型设置为默认值，但您可以将其设置为满足您的需要的值。 如果指定了**表**或**记录**的数据类型，则可能需要更改**Items**属性的值，使其与要输入到组件中的数据架构匹配。 在这种情况下，您需要将其更改为字符串列表。

    如果在右侧窗格的 "**属性**" 选项卡上选择属性的名称，则可以在编辑栏中设置该属性的值。

    !["属性" 选项卡上的自定义输入属性](./media/create-component/properties-tab.png)

    如下图所示，您还可以在右侧窗格的 "**高级**" 选项卡上编辑属性的值。

1. 将组件的**Items**属性设置为以下公式：

    ```powerapps-dot
    Table({Item:"SampleText"})
    ```

    ![公式](./media/create-component/set-component-items.png)

1. 在组件中，插入一个空白垂直**库**控件。

1. 请确保属性列表显示**Items**属性（默认情况下），然后将该属性的值设置为此表达式：

    ```powerapps-dot
    MenuComponent.Items
    ```

    这样一来，**库**控件的**items**属性将读取并依赖于组件的**items** input 属性。

1. 将**库**控件的**BorderThickness**属性设置为**1** ，将其**TemplateSize**属性设置为**50**。

1. 在 "**库**" 控件的模板中，添加 "**标签**" 控件。

    ![添加标签和设置库的边框](./media/create-component/add-label.png)

接下来，将该组件添加到屏幕，并为要显示的组件指定一个字符串表。

1. 在左侧导航栏中，选择屏幕列表，然后选择 "默认屏幕"。

    ![默认屏幕](./media/create-component/default-screen.png)

1. 在 "**插入**" 选项卡上，打开 "**组件**" 菜单，然后选择 " **MenuComponent**"。

    ![&](./media/create-component/insert.png)

    默认情况下，新组件名为**MenuComponent_1** 。

1. 将**MenuComponent_1**的**Items**属性设置为以下公式：

    ```powerapps-dot
    Table({Item:"Home"}, {Item:"Admin"}, {Item:"About"}, {Item:"Help"})
    ```

    此实例与此图形类似，但您可以自定义每个实例的文本和其他属性。

    ![最终库](./media/create-component/menu-instance.png)

到目前为止，您已经创建了一个组件，并将其添加到了应用程序中。 接下来，您将创建一个输出属性，该属性反映用户在菜单中选择的项。

1. 打开组件列表，然后选择 " **MenuComponent**"。

1. 在右侧窗格中，选择 "**属性**" 选项卡，然后选择 "**新建自定义属性**"。

1. 在 "**显示名称**"、"**属性名称**" 和 "**说明**" 框中，键入或粘贴**所选**的。

1. 在 "**属性类型**" 下，选择 "**输出**"，然后选择 "**创建**"。

1. 在 "**高级**" 选项卡上，将**所选**属性的值设置为此表达式，并在必要时调整库名称中的数字：

    ```powerapps-dot
    Gallery1.Selected.Item
    ```

    ![高级窗格](./media/create-component/advance.png)

1. 在应用程序的默认屏幕上，添加一个标签，并将其**Text**属性设置为此表达式，并在必要时调整组件名称中的数字：

    ```powerapps-dot
    MenuComponent_1.Selected
    ```

    请注意， **MenuComponent_1**是实例的默认名称，而不是组件定义的名称。 您可以重命名任何实例。

1. 按住 Alt 键的同时，选择菜单中的每一项。

    "**标签**" 控件反映最近选择的菜单项。

## <a name="known-limitations"></a>已知的限制

- 在撰写本文时，数据源不会与组件一起保存，因此窗体和数据表将处于禁用状态。
- Power Apps 不支持组件中的集合。
- 不能将组件插入库、窗体或数据卡。
- 组件的主实例为本地主机，作用域为应用。 如果更改主实例，则仅应用程序内的组件副本将反映此更改。 除非再次导入组件库，否则其他应用中的副本将保持不变。 这些应用中的所有主实例将自动检测并更新。
- 导入组件时，不能打包媒体文件。
